<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>实时景区列表</title>
    <!-- Bootstrap core CSS -->
    <link href="../../../view/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="jdsslist.css" rel="stylesheet">
  </head>
  <body class="containerdiv">
 <h1 class="text-center">星级酒店</h1> 
  <div class="container ">
	<div class="col-md-12">
		<div class="row ">
			<div class="col-md-12 search">
	  		<button id="searchklbtn" type="button" class="btn btn-success but" onclick="klbtn()">客房入住率</button>
			<input id="searchklinput" type="hidden">
			<!-- Indicates a successful or positive action -->
			<button id="searchcwbtn" type="button" class="btn btn-success but" onclick="cwbtn()">车位密度</button>
			<input id="searchcwinput" type="hidden">
			<!-- Contextual button for informational alert messages -->
			<button id="searchdqbtn" type="button" class="btn btn-success but" onclick="dqbtn()">所属区域</button>
			<input id="searchdqinput" type="hidden">
			<input id="layerNums" type="hidden">
			<input id="currentPage" type="hidden" value="1"/>
			</div>
	  	</div>
	        <div class="row">
               <div id="layerpages" align="right"></div>
          </div>
          <div id="jqsslist" class="row">
             <!-- <div class="col-md-12 jqsslist" onclick="detailJq()">
           		<div class="col-md-2" >
           			<p align="center"><img alt="" src="/pages/sssj/img/hgs.jpg" width="80px" height="80px"></p>
           			<p align="center" class="title">黄果树景区</p>
           		</div>
           		<div class="col-md-5">
            	     <div class="col-md-4 co">
            	     <p>穿衣指数<p>
            	     <p><img alt="" src="/pages/sssj/img/hgs.jpg" width="60px" height="60px"><p>
            	     </div>
            	     <div class="col-md-4 co">
            	     <p>穿衣指数<p>
            	     <p><img alt="" src="/pages/sssj/img/hgs.jpg" width="60px" height="60px"><p>
            	     </div>
            	     <div class="col-md-4 co">
            	     <p>穿衣指数<p>
            	     <p><img alt="" src="/pages/sssj/img/hgs.jpg" width="60px" height="60px"><p>
            	     </div>
           		</div>
           		<div class="col-md-5">
           			<p class="title">通知公告</p>
           			<p>黄果树景区黄果树景区黄果树景区黄果树景区黄果树景区果树景区黄果树景区黄果树景果树景区黄果树景区黄果树景</p>
           		</div>
            </div><!--/.col-md-12-->
            
          </div><!--/row-->
          
        </div>
    </div><!--/.container-->
    
    <div id="kl" style="padding: 30px;display: none;" class="klbtn">
   		<button id="kl0" type="button" class="btn btn-info but" onclick="selectVal('searchklbtn','searchklinput','','客房入住率','客房入住率')">全部</button>
   		<button id="kl1" type="button" class="btn btn-default but" onclick="selectVal('searchklbtn','searchklinput','38','客房入住率','已满')">已满</button>
   		<button id="kl2" type="button" class="btn btn-default but" onclick="selectVal('searchklbtn','searchklinput','37','客房入住率','较满')">较满</button>
   		<button id="kl3" type="button" class="btn btn-default but" onclick="selectVal('searchklbtn','searchklinput','36','客房入住率','一般')">一般</button>
   		<button id="kl4" type="button" class="btn btn-default but" onclick="selectVal('searchklbtn','searchklinput','35','客房入住率','较空闲')">较空闲</button>
   		<button id="kl5" type="button" class="btn btn-default but" onclick="selectVal('searchklbtn','searchklinput','34','客房入住率','空闲')">空闲</button>
    </div>
    
    <div id="cw" style="padding: 30px;display: none;" class="klbtn">
   		<button id="cw0" type="button" class="btn btn-info but" onclick="selectVal('searchcwbtn','searchcwinput','','车位密度','车位密度')">全部</button>
   		<button id="cw1" type="button" class="btn btn-default but" onclick="selectVal('searchcwbtn','searchcwinput','43','车位密度','已满')">已满</button>
   		<button id="cw2" type="button" class="btn btn-default but" onclick="selectVal('searchcwbtn','searchcwinput','42','车位密度','较满')">较满</button>
   		<button id="cw3" type="button" class="btn btn-default but" onclick="selectVal('searchcwbtn','searchcwinput','41','车位密度','一般')">一般</button>
   		<button id="cw4" type="button" class="btn btn-default but" onclick="selectVal('searchcwbtn','searchcwinput','40','车位密度','空闲')">空闲</button>
   		<button id="cw5" type="button" class="btn btn-default but" onclick="selectVal('searchcwbtn','searchcwinput','39','车位密度','较空闲')">较空闲</button>
    </div>
    
    <div id="dq" style="padding: 30px;display: none;" class="klbtn">
   		<button id="dq0" type="button" class="btn btn-info but" onclick="selectVal('searchbtn4','searchinput4','','所属区域','所属区域')">全省</button>
   		<button id="dq1" type="button" class="btn btn-default but" onclick="selectVal('searchbtn4','searchinput4','520100','所属区域','贵阳')">贵阳</button>
   		<button id="dq2" type="button" class="btn btn-default but" onclick="selectVal('searchbtn4','searchinput4','520200','所属区域','六盘水')">六盘水</button>
   		<button id="dq3" type="button" class="btn btn-default but" onclick="selectVal('searchbtn4','searchinput4','520300','所属区域','遵义')">遵义</button>
   		<button id="dq4" type="button" class="btn btn-default but" onclick="selectVal('searchbtn4','searchinput4','520400','所属区域','安顺')">安顺</button>
   		<button id="dq5" type="button" class="btn btn-default but" onclick="selectVal('searchbtn4','searchinput4','520500','所属区域','毕节')">毕节</button>
   		<button id="dq6" type="button" class="btn btn-default but" onclick="selectVal('searchbtn4','searchinput4','520600','所属区域','铜仁')">铜仁</button>
   		<button id="dq7" type="button" class="btn btn-default but" onclick="selectVal('searchbtn4','searchinput4','522300','所属区域','黔西南')">黔西南</button>
   		<button id="dq8" type="button" class="btn btn-default but" onclick="selectVal('searchbtn4','searchinput4','522600','所属区域','黔东南')">黔东南</button>
   		<button id="dq9" type="button" class="btn btn-default but" onclick="selectVal('searchbtn4','searchinput4','522700','所属区域','黔南')">黔南</button>
    </div>
    <script type="text/javascript" src="../../../view/js/jquery-1.10.2.min.js"></script>
    <script type="text/javascript" src="../../../view/js/layer/layer.js"></script>
    <script type="text/javascript" src="../../../view/js/laypage/laypage.js"></script>
    <script type="text/javascript" src="../dragstart.js"></script>
    <script type="text/javascript">
	  //禁止全选
		// $("body").bind("selectstart", function(){
	        // return false;
	    // });
	    layer.config({
		    extend: 'extend/layer.ext.js'
		});
    	function klbtn(){
    		layer.open({
				type:1,
				title: false,
				shadeClose:true,
				shade: 0.1,
				closeBtn: 1,
				area : ['550px','300px'],
				//offset:  ['78px', '40px'],
				offset:  '100px',
			    content: $('#kl')
			    
			});
    	}
    	
    	function cwbtn(){
    		layer.open({
				type:1,
				title: false,
				shadeClose:true,
				shade: 0.1,
				closeBtn: 1,
				area : ['550px','300px'],
				//offset:  ['78px', '40px'],
				offset:  '100px',
			    content: $('#cw')
			    
			});
    	}
    	
    	function dqbtn(){
    		layer.open({
				type:1,
				title: false,
				shadeClose:true,
				shade: 0.1,
				closeBtn: 1,
				area : ['550px','450px'],
				//offset:  ['78px', '40px'],
				offset:  '100px',
			    content: $('#dq')
			    
			});
    	}
    	
    	
    	function detailJq(uid){
    		window.location.href='jdss-detail.html?oId=' + uid;
    	}
    	
    	//var data = '{"pages":"1","info":[{"cwUrl":"../resources/experience/icon/cwmd_04.png","ssdName":"外套","cwName":"较满","publishTime":"2015-12-11 15:36:05","objectName":"梵净山","rzlName":null,"uId":18,"klUrl":"../resources/experience/icon/rlyjd_01.png","ssdUrl":"../resources/experience/icon/ssd_03.png","userType":4,"content":"哈哈","rzlUrl":null,"images":[{"fileUrl":"http://220.197.219.244:8080/travel_resources/travelFile/2015/12/11/20151211153604156283.jpg"}],"headUrl":"http://220.197.219.244:8080/travel_resources/userFile/2015/12/10/20151210223500194551.jpg","klName":"较舒适","video":"http://220.197.219.244:8080/travel_resources/travelFile/2015/12/11/20151211153604574855.mp4"},{"cwUrl":"../resources/experience/icon/cwmd_05.png","ssdName":"棉衣","cwName":"已满","publishTime":"2015-12-10 13:04:50","objectName":"景区测试","rzlName":null,"uId":15,"klUrl":"../resources/experience/icon/rlyjd_04.png","ssdUrl":"../resources/experience/icon/ssd_05.png","userType":4,"content":"测试的","rzlUrl":null,"images":[{"fileUrl":"http://220.197.219.244:8080/travel_resources/travelFile/2015/12/10/20151210130449729556.jpg"},{"fileUrl":"http://220.197.219.244:8080/travel_resources/travelFile/2015/12/10/20151210130449869129.jpg"}],"headUrl":"http://220.197.219.244:8080/travel_resources/userFile/2015/12/10/20151210215607361380.jpg","klName":"拥挤"}]}';
    	function getList(){
    		//参数处理
    		var klinput = $("#searchklinput").val();
    		var cwinput = $("#searchcwinput").val();
    		var dqinput = $("#searchdqinput").val();
    		
    		layer.msg("<span style='color:#000;font-size:20px;'>数据载入中,请稍后...<span>",{icon:16,time:0});
    		
    		var jqsslist = $("#jqsslist");
    		$.ajax({
    			url : 'http://220.197.219.244:8088/travel/classification/getRealTimeInfo',
    			data:{
    				"objectType":"jd_class",   //景区：jq_class、酒店：jd_class、旅游局：lyj_class
    				"pageNo" : $("#currentPage").val(),
    				"pageSize" : 4,
    				"cwmdType" : cwinput,
    				"kfrzlType" : klinput,
    				"city" : dqinput
    			},
    			type:'post',
    		    dataType:'jsonp',
    			success:function(data){
    				//alert(eval("("+data+")"));
    				//var pages = data.pages; //总记录数laypage")
    				
    				laypage({
    				    cont: 'layerpages',
    				    curr:  $("#currentPage").val() || 1,
    				    pages: data.pages,
    				    groups: 4,
    				    skin: '#AF0000',
    				    jump: function(obj,first){
    				    	$("#currentPage").val(obj.curr);
    				    	if(!first){
    				    		getList();
    				    		 
    				    	}
    				    }
    				});
    				
					var infos = data.info;
					var html="";
    				for(var i = 0;i<infos.length;i++){
    					html += "<div class='col-md-12 jqsslist'>";
    				        
   				        html += "<div class='col-md-2  ' onclick='detailJq(" + infos[i].uId + ")'>";
   				        html += "<p align='center'><img src='" + infos[i].headUrl + "' width='100px' height='100px'  class='radimg'></p>";
   				     	html += "<p align='center' class='title'>" + infos[i].objectName  + "</p>";
   				        html += "</div>";
   				        
   				     	html += "<div class='col-md-4' '>"; //onclick='detailJq(" + infos[i].uId + ")'>";
				        
   				     	html += "<div id='divrzl"+ i +"' class='col-md-6 co' onclick='openInfo(\"rzl" + i +"\",\"#divrzl" + i + "\")'>";
				     	html += "<input id='rzl" + i + "' type='hidden' value='" + infos[i].rzlName + "'/>";
				     	html += "<p align='center'>客房入住率<p>";
				        html += "<p align='center'><img src='" + infos[i].rzlUrl +"' width='100px' height='100px'></p>";
				     	html += "</div>";
				     	
				     	html += "<div id='divcw"+ i +"' class='col-md-6 co' onclick='openInfo(\"cw" + i +"\",\"#divcw" + i + "\")'>";
				     	html += "<input id='cw" + i + "' type='hidden' value='" + infos[i].cwName + "'/>";
				     	html += "<p align='center'>车位密度 <p></br>";
				        html += "<p align='center'><img src='" + infos[i].cwUrl +"' width='100px' height='100px'></p>";
				     	html += "</div>";
				     	
   				        html += "</div>";
   				        
   				        html += "<div class='col-md-4'>";
   				        
   				     	html += "<p onclick='openNotice(" + i + ")' class='tiitle'>通知公告: </p>";
                        html += "<p onclick='openNotice(" + i + ")' class='tiitle'>" + infos[i].publishTime +"</p>";
				        if(infos[i].content.length > 23){
				        	html += "<p onclick='openNotice(" + i + ")'>" + infos[i].content.substring(0,22) + "..." + "</p>";
				        }else{
				        	html += "<p onclick='openNotice(" + i + ")'>"  + infos[i].content + "</p>";
				        }
				    	 html += "<input id='notice" + i + "' type='hidden' value='" + infos[i].content + "'/>";
				        //infos[i].content
				        //html += "<p><button type='button' class='btn btn-warning' style='text-align:center;width:150px' onclick='detailJq(" + infos[i].uId + ")'>更多请点击</button></p>"; 
				        
				        html += "</div>";
				         html += "<div class='col-md-2'><p align='center'>即时图片<p>";
	   				     if(infos[i].images != "undefined" && infos[i].images != null){
	   				    	var imglength = infos[i].images.length;
					        if(imglength >= 1){
					        	html += "<div class='' onclick='openPhoto(" + i + ")'>";
		   				     	html += "<p align='center'><img src='" + infos[i].images[0].fileUrl + "' width='120px' height='100px'></p>";

		   				     	var photoDiv = "<div id='photoDiv" + i + "' style='display:none'>";
						        photoDiv += "{'title' :''," +
		        				"'id':'photo" + i + "'," + 
		        				"'start':'0'," +
		        				"'data':["
		   				        for(var j=0;j<imglength;j++){
		   				        	photoDiv += "{'pid':'img"+ j +"'," +
											"'src' : '" + infos[i].images[j].fileUrl + "'" +
											 "}";
									if(j+1 != imglength){
										photoDiv += ",";
									}
		   				        }
		   				     	photoDiv += "]}</div>";
		   				     
		   				     	html += photoDiv;
		   				     	html += "</div>";
					        }
	   				     }else{
                            html += "<p align='center'>暂无！</p>";
                        }
   				        
   				        html += "</div></div>";
    				}
    				jqsslist.html(html);
    				layer.closeAll();
    			},
    			error: function(XMLHttpRequest, textStatus, errorThrown) {
    				 alert(textStatus);
    				 layer.closeAll();
    			 }
    		});
    	}
    	getList();
    	
    	
    	function selectVal(searchBtnId,searchInputId,selectCode,searchBtnName,selectBtnName){
    		if(selectCode == ""){
    			$("#" + searchBtnId).html(searchBtnName);
    		}else{
    			$("#" + searchBtnId).html(selectBtnName);
    		}
    		$("#" + searchInputId).val(selectCode);
    		getList();
    		//getList();
    	}
    	
    	function openPhoto(id){
    		var u = eval('('+$("#photoDiv" + id).html()+')');
    		layer.photos({
    	        photos: u
    	    });
    	}
    	
    	function openNotice(id){
    		layer.open({
				type:1,
				title: false,
				shadeClose:true,
				shade: 0.1,
				closeBtn: 2,
				area : ['550px','300px'],
				//offset:  ['78px', '40px'],
				//offset:  '300px',
			    content: "<div style='color:#000;font-size:18px;padding:20px'>" + $('#notice' + id).val() + "</div>"
			});
    	}
    	
    	function openInfo(name,id){
    		layer.tips("<div style='color:#000;font-size:26px;padding:10px;'>" + $('#' + name).val() + "</div>", id);
    		/*
    		layer.open({
				type:1,
				title: false,
				shadeClose:true,
				shade: 0.1,
				closeBtn: 2,
				area : ['100px','70px'],
				//offset:  ['78px', '40px'],
				//offset:  '100px',
			    content: "<div style='color:#000;font-size:20px;padding:20px;'>" + $('#' + name).val() + "</div>"
			});*/
    	}
    </script>
    
    </body>
</html>